<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bitmovin Player Yospace Integration Test Page</title>
  <meta charset="UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Bitmovin Player -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

  <script type="text/javascript" src="yospace/yo-ad-management.min.js"></script>
  <script type="text/javascript" src="js/bitmovinplayer-yospace.js"></script>

  <script type="text/javascript" src="//cdn.bitmovin.com/player/web/8.2.0-rc2/bitmovinplayer-ui.js"></script>
  <link rel="stylesheet" href="//cdn.bitmovin.com/player/web/8.2.0-rc2/bitmovinplayer-ui.css">
  <style>
    .player-wrapper {
      margin: 20px auto;
      box-shadow: 0 0 30px rgba(0,0,0,0.7);
    }
    .meta-info {
      text-align: center;
    }
    .row {
      margin: 20px 0;
    }
  </style>
</head>
<body>
<div class="container">
  <div class="meta-info">
    <div class="row">
      <div class="col-12">
        <div class="btn-group btn-group-toggle" data-toggle="buttons">
          <label class="btn btn-outline-secondary active">
            <input type="radio" name="options" id="option-vod" autocomplete="off" checked>Load VOD
          </label>
          <label class="btn btn-outline-secondary">
            <input type="radio" name="options" id="option-vod-vpaid" autocomplete="off" checked>Load VOD + VPAID
          </label>
          <label class="btn btn-outline-secondary">
            <input type="radio" name="options" id="option-live" autocomplete="off">Load Live
          </label>
          <label class="btn btn-outline-secondary">
            <input type="radio" name="options" id="option-truex" autocomplete="off">Load TrueX
          </label>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="input-group mb-3">
          <input id="steam-stream-url" type="text" class="form-control" placeholder="Custom Stream URL" aria-label="Custom Stream URL">
          <select class="custom-select col-2" id="stream-type-select">
            <option value="1" selected>VoD</option>
            <option value="2">Live</option>
          </select>
          <div class="input-group-append">
            <button id="load-custom-steam" class="btn btn-outline-secondary" type="button">Load</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="content">
    <div class="player-wrapper">
      <div id="player"></div>
    </div>
  </div>
</div>
<script type="text/javascript">
  var yospacePlayer;

  var vodButton = $('#option-vod').parent();
  var vodVpaidButton = $('#option-vod-vpaid').parent();
  var liveButton = $('#option-live').parent();
  var truexButton = $('#option-truex').parent();
  var customStreamButton = $('#load-custom-steam');

  function deselectCustomLoadButton() {
    $(customStreamButton).removeClass('active');
  }

  vodButton.on('click', function() {
    vodButton.button('toggle');
    deselectCustomLoadButton();

    yospacePlayer.unload();
    yospacePlayer.load(vodSource);
  });

  vodVpaidButton.on('click', function() {
    vodVpaidButton.button('toggle');
    deselectCustomLoadButton();

    yospacePlayer.unload();
    yospacePlayer.load(vodVpaidSource);
  });

  liveButton.on('click', function() {
    liveButton.button('toggle');
    deselectCustomLoadButton();

    yospacePlayer.unload();
    yospacePlayer.load(liveSource);
  });

  truexButton.on('click', function() {
    truexButton.button('toggle');
    deselectCustomLoadButton();

    yospacePlayer.unload();
    yospacePlayer.load(truexSource);
  });

  customStreamButton.on('click', function() {
    $(customStreamButton).addClass('active');

    // remove active button of group
    $($('.btn-group-toggle .active')[0]).removeClass('active');
    var customSource = {
      title: 'Custom Stream',
      hls: $('#steam-stream-url').val(),

      assetType: $('#stream-type-select').val() === '1' ? bitmovin.player.ads.yospace.YospaceAssetType.VOD : bitmovin.player.ads.yospace.YospaceAssetType.LINEAR,
    };
    yospacePlayer.unload();
    yospacePlayer.load(customSource);
  });

  var liveSource = {
    title: 'Live Stream',
    hls: 'https://csm-e-stg.tls1.yospace.com/csm/extlive/turnerdev01,tbse-clear.m3u8?yo.ac=true&yo.ad=true&yo.ch=true',

    // Yospace configuration
    assetType: bitmovin.player.ads.yospace.YospaceAssetType.LINEAR
  };

  var vodSource = {
    title: 'VOD Stream',
    hls: 'https://csm-e-stg.tls1.yospace.com/csm/access/525947592/cWEvY21hZl9hZHZhbmNlZF9mbXA0X2Zyb21faW50ZXIvcHJvZ19zZWcvbXdjX0NBUkUxMDA5MjYxNzAwMDE4ODUyL2NsZWFyLzNjM2MzYzNjM2MzYzNjM2MzYzNjM2MzYzNjM2MzYzNjL21hc3Rlcl9jbF9ub19pZnJhbWUubTN1OA==?yo.av=2&yo.ad=true',

    // Yospace configuration
    assetType: bitmovin.player.ads.yospace.YospaceAssetType.VOD
  };

  var vodVpaidSource = {
    title: 'VOD Stream',
    hls: 'https://csm-e-turnerstg-5p30c9t6lfad.tls1.yospace.com/csm/access/525951113/cWEvY21hZl9hZHZhbmNlZF9mbXA0X2Zyb21faW50ZXIvcHJvZ19zZWcvbXdjX0NBUkUxMDA5MjYxNzAwMDE4ODUyL2NsZWFyLzNjM2MzYzNjM2MzYzNjM2MzYzNjM2MzYzNjM2MzYzNjL21hc3Rlcl9jbF9ub19pZnJhbWUubTN1OA==?yo.av=2&yo.ad=true&yo.ac=true',

    // Yospace configuration
    assetType: bitmovin.player.ads.yospace.YospaceAssetType.VOD
  };

  var truexSource = {
    title: 'TrueX VOD Stream',
    hls: 'https://csm-e-stg.tls1.yospace.com/csm/access/525943851/cWEvY21hZl9hZHZhbmNlZF9mbXA0X2Zyb21faW50ZXIvcHJvZ19zZWcvbXdjX0NBUkUxMDA5MjYxNzAwMDE4ODUyL2NsZWFyLzNjM2MzYzNjM2MzYzNjM2MzYzNjM2MzYzNjM2MzYzNjL21hc3Rlcl9jbF9ub19pZnJhbWUubTN1OA==?yo.av=2&yo.ad=true\n',

    // Yospace configuration
    assetType: bitmovin.player.ads.yospace.YospaceAssetType.VOD
  };

  var conf = {
    key: 'YOUR-PLAYER-KEY',
    playback: {
      muted: true,
      autoplay: true
    },
    ui: false,
  };

  // Yospace configuration
  var yospaceConfig = {
      debug: true
  };

  var playerContainer = document.getElementById('player');
  yospacePlayer = new bitmovin.player.ads.yospace.BitmovinYospacePlayer(playerContainer, conf, yospaceConfig);

  bitmovin.playerui.UIFactory.buildDefaultUI(yospacePlayer);

  yospacePlayer.load(vodSource).then(function() {
      console.log('loaded');
  }).catch(function() {
      console.log('gotcha');
  });

  yospacePlayer.on('yospaceerror', function(event) {
    console.error(event);
  })

</script>
</body>
</html>
